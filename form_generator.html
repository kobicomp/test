<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מחולל טפסי הזמנה לאירועים</title>
    <style>
        :root {
            --primary-color: #2196F3;
            --secondary-color: #4b6cb7;
            --success-color: #4CAF50;
            --danger-color: #f44336;
            --warning-color: #ff9800;
            --light-color: #f5f5f5;
            --dark-color: #333;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            direction: rtl;
            background-color: var(--light-color);
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(to left, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px 0;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            border-radius: 0 0 10px 10px;
        }

        .header h1 {
            margin: 0;
            font-size: 2.2em;
        }

        .form-card {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            padding: 25px;
            margin-bottom: 30px;
        }

        .form-title {
            font-size: 1.8em;
            color: var(--dark-color);
            margin: 0 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
            transition: border 0.3s ease;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-group input:focus, .form-group textarea:focus, .form-group select:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-col {
            flex: 1;
        }

        .section-title {
            margin-top: 25px;
            margin-bottom: 15px;
            color: var(--primary-color);
            font-size: 1.3em;
            border-right: 4px solid var(--primary-color);
            padding-right: 10px;
        }

        .color-preview {
            display: inline-block;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin-right: 10px;
            vertical-align: middle;
            border: 1px solid #ddd;
        }

        .btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
        }

        .btn-success {
            background-color: var(--success-color);
        }

        .btn-success:hover {
            background-color: #3d9140;
        }

        .actions {
            margin-top: 30px;
            text-align: center;
        }

        .form-info {
            background-color: #e8f5e9;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            font-size: 0.9em;
        }

        .form-info h4 {
            margin-top: 0;
            color: var(--success-color);
        }

        .form-info ul {
            padding-right: 20px;
        }

        .form-info li {
            margin-bottom: 5px;
        }

        .result-container {
            display: none;
            margin-top: 30px;
        }

        .result-box {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
            height: 300px;
            overflow: auto;
            margin-bottom: 15px;
            direction: ltr;
            text-align: left;
            font-family: monospace;
            white-space: pre;
            font-size: 12px;
        }

        .result-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }

        .loading .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .help-tip {
            font-size: 0.85em;
            color: #666;
            margin-top: 5px;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border: 1px solid transparent;
            border-bottom: none;
            margin-right: 5px;
            border-radius: 5px 5px 0 0;
            background-color: #f5f5f5;
        }
        
        .tab.active {
            background-color: white;
            border-color: #ddd;
            border-bottom: 2px solid var(--primary-color);
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }

        #templateUploadContainer {
            margin-bottom: 20px;
            padding: 20px;
            border: 2px dashed #ccc;
            border-radius: 10px;
            text-align: center;
        }

        #templateUploadContainer.template-loaded {
            border-color: var(--success-color);
            background-color: rgba(76, 175, 80, 0.1);
        }

        .template-status {
            margin-top: 10px;
            font-weight: bold;
        }

        .template-status.error {
            color: var(--danger-color);
        }

        .template-status.success {
            color: var(--success-color);
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>מחולל טפסי הזמנה לאירועים</h1>
        </div>
    </div>

    <div class="container">
        <div id="templateUploadContainer">
            <h3>קובץ תבנית (base_template.html)</h3>
            <p>יש לבחור את קובץ התבנית כדי להמשיך</p>
            <input type="file" id="templateFileInput" accept=".html">
            <div id="templateStatus" class="template-status"></div>
        </div>

        <div class="form-card">
            <h2 class="form-title">הגדרות טופס ההזמנה</h2>
            
            <div class="tabs">
                <div class="tab active" data-tab="basic-info">מידע בסיסי</div>
                <div class="tab" data-tab="google-form">טופס Google</div>
                <div class="tab" data-tab="design">עיצוב</div>
            </div>
            
            <div class="tab-content active" id="basic-info">
                <h3 class="section-title">פרטי האירוע</h3>
                <div class="form-group">
                    <label for="projectName">שם מלא של הפרויקט/האירוע:</label>
                    <input type="text" id="projectName" placeholder="לדוגמה: אפיית מצות בבית הכנסת דורש טוב התשפ״ה" value="אפיית מצות בבית הכנסת דורש טוב התשפ״ה">
                    <div class="help-tip">שם מלא של האירוע כפי שירשם במערכת</div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="projectTitle">כותרת ראשית:</label>
                            <input type="text" id="projectTitle" placeholder="לדוגמה: אפיית מצות - בית הכנסת דורש טוב" value="אפיית מצות - בית הכנסת דורש טוב">
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="projectSubtitle">כותרת משנה:</label>
                            <input type="text" id="projectSubtitle" placeholder="לדוגמה: הזמנת מקומות לאפיית מצות לקראת חג הפסח" value="הזמנת מקומות לאפיית מצות לקראת חג הפסח התשפ״ה">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="projectDescription">תיאור האירוע:</label>
                    <textarea id="projectDescription" placeholder="תיאור מפורט של האירוע...">שלום לכולם!
פרויקט קהילות של עיריית שדרות שמח להזמין את ציבור הגברים בקהילת "דורש טוב" לאפיית מצות מהודרות ביום שני, ט' בניסן בשעה 19:00 ברחבת בית הכנסת "משכן בניה".
שימו לב! מס' המקומות מוגבל, כל הקודם זוכה.
ההשתתפות בעלות מסובסדת בסך 10 ש"ח.
הרב יניב וועד בית הכנסת</textarea>
                </div>

                <div class="form-group">
                    <label for="decorationText">משפט קישוט (אופציונלי):</label>
                    <input type="text" id="decorationText" placeholder="ציטוט או משפט שיופיע בתחתית הטופס" value="הא לחמא עניא די אכלו אבהתנא בארעא דמצרים">
                    <div class="help-tip">משפט קישוטי שיופיע בתחתית הטופס (למשל ציטוט מתאים לאירוע)</div>
                </div>

                <h3 class="section-title">הגדרות הזמנה</h3>
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="totalSlots">מספר מקומות כולל:</label>
                            <input type="number" id="totalSlots" min="1" value="30">
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="maxSlotsPerBooking">מקסימום מקומות להזמנה בודדת:</label>
                            <input type="number" id="maxSlotsPerBooking" min="1" max="20" value="5">
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="isPaid">האם האירוע בתשלום?</label>
                            <select id="isPaid">
                                <option value="yes">כן</option>
                                <option value="no">לא</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="pricePerPerson">מחיר לאדם (בש"ח):</label>
                            <input type="number" id="pricePerPerson" min="0" value="10">
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="paymentLink">קישור לתשלום:</label>
                            <input type="url" id="paymentLink" placeholder="https://..." value="https://pe4ch.com/ref/2DKFWoG22che?lang=he">
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="google-form">
                <h3 class="section-title">הגדרות טופס Google</h3>
                <div class="form-group">
                    <label for="googleFormUrl">קישור לטופס Google:</label>
                    <input type="url" id="googleFormUrl" placeholder="https://docs.google.com/forms/d/e/..." value="https://docs.google.com/forms/d/e/1FAIpQLSfMRzTBNEKqeg_ubQwhPNr9u78h5a3ynPdsq7q77azwKF9S9g/formResponse">
                    <div class="help-tip">הקישור המלא של ה-Google Form שנוצר (נדרש להכיל 'formResponse' בסוף)</div>
                </div>
                
                <div class="form-group">
                    <label for="googleSheetUrl">קישור לפרסום הטבלה (CSV):</label>
                    <input type="url" id="googleSheetUrl" placeholder="https://docs.google.com/spreadsheets/d/e/..." value="https://docs.google.com/spreadsheets/d/e/2PACX-1vTZuqwnqomuxxsB2lIcXp4VHBQqwzEoHJ9t99Kb057hIr8GQEOnbmw9NxLkztaER59W572o3kVymiyx/pub?output=csv">
                    <div class="help-tip">קישור לטבלת Google Sheets המפורסמת כ-CSV</div>
                </div>
                
                <h3 class="section-title">מזהי שדות טופס Google</h3>
                <div class="form-info">
                    <h4>כיצד למצוא את מזהי השדות?</h4>
                    <ol>
                        <li>פתח את הטופס ב-Google Forms במצב עריכה</li>
                        <li>לחץ על כפתור הצפייה (עין) כדי לראות את הטופס במצב תצוגה מקדימה</li>
                        <li>לחץ קליק ימני ובחר "צפה בקוד מקור של העמוד" (View Page Source)</li>
                        <li>חפש את מזהי השדות בפורמט "entry.XXXXXXXXXX"</li>
                    </ol>
                </div>
                
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="formFieldFirstName">מזהה שדה שם פרטי:</label>
                            <input type="text" id="formFieldFirstName" placeholder="entry.XXXXXXXXXX" value="entry.1726269772">
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="formFieldLastName">מזהה שדה שם משפחה:</label>
                            <input type="text" id="formFieldLastName" placeholder="entry.XXXXXXXXXX" value="entry.1766470893">
                        </div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="formFieldPhone">מזהה שדה טלפון:</label>
                            <input type="text" id="formFieldPhone" placeholder="entry.XXXXXXXXXX" value="entry.2028941780">
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="formFieldQuantity">מזהה שדה כמות:</label>
                            <input type="text" id="formFieldQuantity" placeholder="entry.XXXXXXXXXX" value="entry.1406108683">
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="formFieldProjectName">מזהה שדה שם הפרויקט:</label>
                            <input type="text" id="formFieldProjectName" placeholder="entry.XXXXXXXXXX" value="entry.1414374653">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <button class="btn" id="parseGoogleFormBtn">חלץ מזהים אוטומטית מקישור הטופס</button>
                    <div class="help-tip">לחיצה על כפתור זה תנסה לחלץ את מזהי השדות אוטומטית מקישור הטופס</div>
                </div>
            </div>
            
            <div class="tab-content" id="design">
                <h3 class="section-title">הגדרות עיצוב</h3>
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="primaryColor">צבע ראשי:</label>
                            <div>
                                <div class="color-preview" id="primaryColorPreview" style="background-color: #2196F3;"></div>
                                <input type="color" id="primaryColor" value="#2196F3">
                            </div>
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="secondaryColor">צבע משני:</label>
                            <div>
                                <div class="color-preview" id="secondaryColorPreview" style="background-color: #4b6cb7;"></div>
                                <input type="color" id="secondaryColor" value="#4b6cb7">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="useLogo">האם להשתמש בלוגו?</label>
                    <select id="useLogo">
                        <option value="no">לא</option>
                        <option value="yes">כן</option>
                    </select>
                </div>
                
                <div class="form-group" id="logoUrlGroup" style="display: none;">
                    <label for="logoUrl">קישור ללוגו:</label>
                    <input type="url" id="logoUrl" placeholder="https://example.com/logo.jpg">
                    <div class="help-tip">נדרש להיות קישור ישיר לתמונת הלוגו. גודל מומלץ: 150px רוחב</div>
                </div>
            </div>
            
            <div class="actions">
                <button class="btn btn-success" id="generateBtn" disabled>צור קוד טופס</button>
            </div>
        </div>
        
        <div class="form-card result-container" id="resultContainer">
            <h2 class="form-title">הקוד נוצר בהצלחה!</h2>
            <p>העתק את הקוד הבא ושמור אותו כקובץ HTML:</p>
            
            <div class="result-box" id="resultCode"></div>
            
            <div class="result-actions">
                <button class="btn" id="copyBtn">העתק קוד</button>
                <button class="btn" id="downloadBtn">הורד כקובץ HTML</button>
            </div>
        </div>
        
        <div class="loading" id="loadingIndicator">
            <div class="spinner"></div>
            <p>מייצר את הקוד...</p>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        let templateContent = '';
        const generateBtn = document.getElementById('generateBtn');
        const templateFileInput = document.getElementById('templateFileInput');
        const templateStatus = document.getElementById('templateStatus');
        const templateContainer = document.getElementById('templateUploadContainer');
        
        // טעינת קובץ התבנית
        templateFileInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) {
                templateStatus.textContent = 'לא נבחר קובץ';
                templateStatus.className = 'template-status';
                generateBtn.disabled = true;
                templateContainer.classList.remove('template-loaded');
                return;
            }
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                templateContent = e.target.result;
                
                if (templateContent && templateContent.includes('{{PROJECT_TITLE}}')) {
                    templateStatus.textContent = 'קובץ התבנית נטען בהצלחה!';
                    templateStatus.className = 'template-status success';
                    generateBtn.disabled = false;
                    templateContainer.classList.add('template-loaded');
                } else {
                    templateStatus.textContent = 'הקובץ שנבחר אינו תבנית תקינה. אנא וודא שזהו קובץ base_template.html תקין.';
                    templateStatus.className = 'template-status error';
                    generateBtn.disabled = true;
                    templateContainer.classList.remove('template-loaded');
                }
            };
            
            reader.onerror = function() {
                templateStatus.textContent = 'שגיאה בטעינת הקובץ, אנא נסה שנית';
                templateStatus.className = 'template-status error';
                generateBtn.disabled = true;
                templateContainer.classList.remove('template-loaded');
            };
            
            reader.readAsText(file);
        });
        
        // מעבר בין לשוניות
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // הסרת הקלאס מכל הלשוניות
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                
                // הסתרת כל התוכן של הלשוניות
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // הצגת הלשונית הנוכחית
                this.classList.add('active');
                const tabId = this.getAttribute('data-tab');
                document.getElementById(tabId).classList.add('active');
            });
        });
        
        // עדכון תצוגה מקדימה של צבעים
        document.getElementById('primaryColor').addEventListener('input', function() {
            document.getElementById('primaryColorPreview').style.backgroundColor = this.value;
        });
        
        document.getElementById('secondaryColor').addEventListener('input', function() {
            document.getElementById('secondaryColorPreview').style.backgroundColor = this.value;
        });
        
        // טיפול בלוגו
        document.getElementById('useLogo').addEventListener('change', function() {
            document.getElementById('logoUrlGroup').style.display = this.value === 'yes' ? 'block' : 'none';
        });
        
        // חילוץ מזהים מקישור טופס
        document.getElementById('parseGoogleFormBtn').addEventListener('click', function() {
            alert('תכונה זו תהיה זמינה בקרוב. כרגע יש להזין את המזהים ידנית.');
        });
        
        // יצירת הקוד
        document.getElementById('generateBtn').addEventListener('click', function() {
            if (!templateContent) {
                alert('אנא טען את קובץ התבנית תחילה');
                return;
            }
            
            const loadingIndicator = document.getElementById('loadingIndicator');
            const resultContainer = document.getElementById('resultContainer');
            const resultCode = document.getElementById('resultCode');
            
            loadingIndicator.style.display = 'block';
            
            // טיפול בערכים
            setTimeout(() => {
                const projectName = document.getElementById('projectName').value;
                const projectTitle = document.getElementById('projectTitle').value;
                const projectSubtitle = document.getElementById('projectSubtitle').value;
                const projectDescription = document.getElementById('projectDescription').value;
                const decorationText = document.getElementById('decorationText').value;
                const totalSlots = document.getElementById('totalSlots').value;
                const maxSlotsPerBooking = document.getElementById('maxSlotsPerBooking').value;
                const isPaid = document.getElementById('isPaid').value;
                const pricePerPerson = document.getElementById('pricePerPerson').value;
                const paymentLink = document.getElementById('paymentLink').value;
                const googleFormUrl = document.getElementById('googleFormUrl').value;
                const googleSheetUrl = document.getElementById('googleSheetUrl').value;
                const formFieldFirstName = document.getElementById('formFieldFirstName').value;
                const formFieldLastName = document.getElementById('formFieldLastName').value;
                const formFieldPhone = document.getElementById('formFieldPhone').value;
                const formFieldQuantity = document.getElementById('formFieldQuantity').value;
                const formFieldProjectName = document.getElementById('formFieldProjectName').value;
                const primaryColor = document.getElementById('primaryColor').value;
                const secondaryColor = document.getElementById('secondaryColor').value;
                const useLogo = document.getElementById('useLogo').value;
                const logoUrl = document.getElementById('logoUrl').value;
                
                // יצירת HTML ללוגו אם נדרש
                const logoHtml = useLogo === 'yes' && logoUrl 
                    ? `<img src="${logoUrl}" alt="לוגו" class="logo">`
                    : '';
                
                // יצירת HTML למחיר
                const priceHtml = isPaid === 'yes' 
                    ? `<div class="price-info">עלות: <span id="price-per-person">${pricePerPerson}</span> ₪ לאדם</div>`
                    : `<div class="price-info">השתתפות ללא עלות</div>`;
                
                // יצירת HTML לקישור תשלום
                const paymentLinkHtml = isPaid === 'yes' && paymentLink
                    ? `<a href="${paymentLink}" class="payment-link" target="_blank">קישור לתשלום</a>`
                    : '';
                
                // יצירת מפתח אחסון ייחודי
                const storageKey = projectName
                    .replace(/[^a-zA-Z0-9]/g, '_')
                    .toLowerCase()
                    .substring(0, 20) + '_' + new Date().getFullYear();
                
            // החלפת התגיות בתבנית
                let generatedCode = templateContent
                    .replace(/{{TITLE}}/g, projectTitle)
                    .replace(/{{PROJECT_NAME}}/g, projectName)
                    .replace(/{{PROJECT_TITLE}}/g, projectTitle)
                    .replace(/{{PROJECT_SUBTITLE}}/g, projectSubtitle)
                    .replace(/{{PROJECT_DESCRIPTION}}/g, projectDescription)
                    .replace(/{{DECORATION_TEXT}}/g, decorationText)
                    .replace(/{{TOTAL_SLOTS}}/g, totalSlots)
                    .replace(/{{MAX_SLOTS_PER_BOOKING}}/g, maxSlotsPerBooking)
                    .replace(/{{PRICE_PER_PERSON}}/g, pricePerPerson)
                    .replace(/{{PAYMENT_LINK}}/g, paymentLink)
                    .replace(/{{GOOGLE_FORM_URL}}/g, googleFormUrl)
                    .replace(/{{GOOGLE_SHEET_URL}}/g, googleSheetUrl)
                    .replace(/{{FORM_FIELD_FIRST_NAME}}/g, formFieldFirstName)
                    .replace(/{{FORM_FIELD_LAST_NAME}}/g, formFieldLastName)
                    .replace(/{{FORM_FIELD_PHONE}}/g, formFieldPhone)
                    .replace(/{{FORM_FIELD_QUANTITY}}/g, formFieldQuantity)
                    .replace(/{{FORM_FIELD_PROJECT_NAME}}/g, formFieldProjectName)
                    .replace(/{{PRIMARY_COLOR}}/g, primaryColor)
                    .replace(/{{SECONDARY_COLOR}}/g, secondaryColor)
                    .replace(/{{LOGO_HTML}}/g, logoHtml)
                    .replace(/{{PRICE_HTML}}/g, priceHtml)
                    .replace(/{{PAYMENT_LINK_HTML}}/g, paymentLinkHtml)
                    .replace(/{{PROJECT_STORAGE_KEY}}/g, storageKey);
                
                resultCode.textContent = generatedCode;
                
                loadingIndicator.style.display = 'none';
                resultContainer.style.display = 'block';
                
                window.scrollTo({
                    top: resultContainer.offsetTop - 20,
                    behavior: 'smooth'
                });
            }, 1000);
        });
        
        // העתקת קוד
        document.getElementById('copyBtn').addEventListener('click', function() {
            const resultCode = document.getElementById('resultCode');
            
            // יצירת אלמנט זמני לצורך העתקה
            const tempTextarea = document.createElement('textarea');
            tempTextarea.value = resultCode.textContent;
            document.body.appendChild(tempTextarea);
            tempTextarea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextarea);
            
            this.textContent = 'הועתק!';
            setTimeout(() => {
                this.textContent = 'העתק קוד';
            }, 2000);
        });
        
        // הורדת קובץ HTML
        document.getElementById('downloadBtn').addEventListener('click', function() {
            const resultCode = document.getElementById('resultCode').textContent;
            const projectTitle = document.getElementById('projectTitle').value;
            const filename = projectTitle
                .replace(/[^a-zA-Z0-9]/g, '_')
                .toLowerCase() + '_form.html';
            
            const blob = new Blob([resultCode], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });
    });
    </script>
</body>
</html>
